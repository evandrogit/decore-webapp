<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui"
	template="/WEB-INF/template.xhtml">

	<ui:define name="title">Consultar Produto</ui:define>

	<f:metadata>
		<f:viewAction action="#{estoqueBean.inicializar}" /> 
	</f:metadata>

	<ui:define name="content">

		<style>
@media ( min-width :220px) {
	.panel-btn.ui-panel .ui-panel-content {
	    padding: 6px 8px !important;
	    border: none;		
	}
	.fotoDialog_ .ui-state-disabled {
    	opacity: 1;
    }
	.image-produto_ {
		width: 66%;
	    height: auto;
	    margin-top: 0px;
	    max-height: 210px;
	}
	.font-column {
		font-size: 14px !important;
	}
	.font-column_{
		font-size: 14px !important;
	}
	.ui-datatable tbody td {
		height: auto !important;
	}
	.fotoDialog {
		max-height: 380px !important;
		width: 240px !important;
		margin-top: -50px;
	}
	.categoria-field {
		width: 100%;
		height: 32px;
	}
	.ui-slider .ui-slider-handle {
		width: 1.7em;
		height: 1.7em;
	}
	.ui-slider-horizontal {
		height: 1.2em !important;
	}
	body .ui-fluid .ui-trigger-calendar .ui-datepicker-trigger.ui-button {
		height: 28px !important;
	}
	.result .apply-result .ui-grid-responsive .ui-grid-col-4 {
		width: 50% !important;
		float: left !important;
	}
	.result .apply-result .ui-grid-responsive .ui-grid-col-6 {
		width: 50% !important;
		float: left !important;
	}
	.qty-parcelas.ui-panelgrid .ui-panelgrid-cell:nth-child(1) {
		margin-top: 10px !important;
	}
	.percentual-juros.ui-panelgrid .ui-panelgrid-cell:nth-child(1) {
		margin-top: 8px !important;
	}
	.ui-datatable thead th, .ui-datatable tbody td, .ui-datatable tfoot td,
		.ui-datatable tfoot th {
		font-size: 13px;
	}
	body .btn-new.ui-button {
		color: #676363;
		background-color: #f9f9f9;
		border: 1px solid #8a8585;
	}
	.swal2-popup {
		width: 28em;
		max-width: 100%;
		padding: 0 0 0.4em 0;
		font-size: 0.75rem;
	}
	.swal2-popup #swal2-content {
		font-weight: 400;
	}
	.qty-field .ui-inputfield {
		width: 63px !important;
	}
	
	.fotoDialog_ .ui-panel .ui-panel-content {
    	border: none;
    }
    
    .fotoDialog_ {
		max-height: 652px !important;
    	width: 350px !important;
	}
	
	.info-valores.ui-panel .ui-panel-content {
    	padding: 0px;
    }
	
	.fotoDialog_ .ui-panelgrid .ui-panelgrid-cell {
    	padding: 4px 4px;
    }
    
    .line {
    	width: 100%;
	    margin: auto;
	    border-top: 1px solid #ccc;
	    margin-top: 10px;
	    margin-bottom: 10px;
    }
    
    .fotoDialog_ .ui-button.ui-button-icon-only .ui-icon {
	    margin-top: -6px;
	    margin-left: -7px;
	    color: #1d1c1c;
	}
	
}

@media ( min-width :460px) {
	.image-produto_ {
		width: 100%;
	    height: auto;
	    margin-top: 0px;
	    max-height: 210px;
	}
	.line {
    	width: 100%;
	    margin: auto;
	    border-top: 1px solid #ccc;
	    margin-top: -2px;
	    margin-bottom: 10px;
    }
    
	.font-column {
		font-size: 13px !important;
	}
	.font-column_{
		font-size: 12px !important;
	}
	.ui-slider .ui-slider-handle {
		width: 1.7em;
		height: 1.7em;
	}
	.ui-slider-horizontal {
		height: 1.2em;
	}
	body .ui-fluid .ui-trigger-calendar .ui-datepicker-trigger.ui-button {
		height: 27px !important;
	}
	.ui-datatable thead th, .ui-datatable tbody td, .ui-datatable tfoot td,
		.ui-datatable tfoot th {
		font-size: 14px;
	}
	.fotoDialog_ {
		max-height: 500px !important;
		width: 500px !important;
		margin-top: -50px;
	}
	.fotoDialog_ .ui-inputtext {
	    width: 100%;
	}
	.fotoDialog_ .ui-panelgrid .ui-panelgrid-cell {
    	padding: 4px 4px;
    }
    
    .info-valores.ui-panel .ui-panel-content {
    	padding: 0px;
    }
}

@media ( min-width :640px) {
	.categoria-field {
		width: 60% !important;
	}
	.ui-slider-handle {
		width: 1.2em !important;
		height: 1.2em !important;
	}
	.ui-slider-horizontal {
		height: 0.8em !important;
	}
	body .ui-fluid .ui-trigger-calendar .ui-datepicker-trigger.ui-button {
		height: 27px !important;
	}
	.result .apply-result .ui-grid-responsive .ui-grid-col-4 {
		width: 33.33333% !important;
		float: none;
	}
	.result .apply-result .ui-grid-responsive .ui-grid-col-6 {
		width: auto !important;
		float: none;
	}
	.fotoDialog {
		max-height: 500px !important;
		width: 240px !important;
		margin-top: -50px;
	}
	.ui-datatable tbody td {
		height: 28px !important;
	}
}
</style>

		<div class="page-header">
			<h1>Consultar Produto</h1>
		</div>

		<p:growl id="msg" closable="true" life="500" showSummary="false"
			showDetail="true" style="text-align: center" />



		<h:form id="form" prependId="false">

			<p:toolbar id="toolbar">
				<f:facet name="left">
					<p:commandButton icon="fa fa-fw fa-search" value="Pesquisar"
						id="pesquisar-button" update="panel-table produtosTable form"
						style="margin-left: 3px;font-weight:bold" process="form"
						action="#{estoqueBean.pesquisar}"
						onstart="PF('downloadLoading').show();"
						oncomplete="PF('downloadLoading').hide();"></p:commandButton>
				</f:facet>

			</p:toolbar>
			
			<p:remoteCommand name="setarItemID" process="@this"
				update="form" action="#{estoqueBean.excluir}"
				onstart="PF('downloadLoading').show();"
				oncomplete="PF('downloadLoading').hide();" />

			<div class="ui-g-12 ui-lg-12">

				<p:panel class="card card-w-title ui-fluid itens-add"
					style="padding-bottom: 0px !important; margin-top:10px">

					<p:panelGrid columns="2" id="painel" layout="grid"
						styleClass="panelgrid-noborder disabled disabled"
						columnClasses="ui-grid-col-2, ui-grid-col-4">

						<p:outputLabel value="Código ou Descrição" for="descricao" />
						<p:inputText id="descricao"
							value="#{estoqueBean.filter.descricao}" />


						<p:outputLabel value="Categoria" for="categoria" />
						<p:selectOneMenu id="categoria" styleClass="categoria-field"
							value="#{estoqueBean.filter.categoriaProduto}">
							<f:selectItem itemLabel="Selecione" itemValue="" />
							<f:selectItems value="#{estoqueBean.todasCategoriasProdutos}"
								var="categoria" itemLabel="#{categoria.nome}"
								itemValue="#{categoria}"></f:selectItems>
						</p:selectOneMenu>

					</p:panelGrid>

					<p:panelGrid columns="2" layout="grid" rendered="false"
						styleClass="panelgrid-noborder disabled disabled"
						columnClasses="ui-grid-col-2, ui-grid-col-1">

						<p:outputLabel value="Pedido" />
						<p:inputSwitch offLabel="Não" onLabel="Sim"
							value="#{estoqueBean.pedido}">
							<p:ajax event="change" process="@this" update="qty btn-qty"
								onstart="PF('downloadLoading').show();"
								oncomplete="PF('downloadLoading').hide();" />
						</p:inputSwitch>
					</p:panelGrid>

					<p:panelGrid columns="3" layout="grid" rendered="false"
						styleClass="panelgrid-noborder disabled disabled"
						columnClasses="ui-grid-col-2, ui-grid-col-1">

						<p:outputLabel value="QTY" for="qty" />
						<p:inputNumber id="qty" styleClass="qty-field" decimalPlaces="0"
							value="#{estoqueBean.quantidadePedido}" placeholder="0"
							autocomplete="off" disabled="#{not estoqueBean.pedido}">
						</p:inputNumber>

						<p:commandButton icon="fa fa-fw fa-search" update="produtosTable"
							disabled="#{not estoqueBean.pedido}" id="btn-qty"
							rendered="false"
							style="margin-left: -20px;font-weight:bold; float:left; width: 38px"
							process="form" action="#{estoqueBean.pesquisar}"
							onstart="PF('downloadLoading').show();"
							oncomplete="PF('downloadLoading').hide();"></p:commandButton>

					</p:panelGrid>

				</p:panel>

				<p:panel class="card card-w-title ui-fluid itens-add"
					id="panel-table"
					style="padding-bottom: 0px !important;margin-top:-10px">

					<h3 style="font-weight: bold">Resultado da consulta</h3>
										

					<p:menuButton id="foto-button" value="Opções"
						style="width: 80px;float: right;margin-top: -40px;margin-right: 10px"
						disabled="#{estoqueBean.produtoSelecionado.id == null}">	
						
						<p:menuitem actionListener="#{estoqueBean.prepareFoto}" value="Visualizar" icon="fa fa-fw fa-eye" onstart="PF('downloadLoading').show();"
							 update="produto-dialog_ form-dialog" oncomplete="PF('downloadLoading').hide();PF('produto-dialog_').show();"></p:menuitem>
						
						<p:separator />
						<p:menuitem value="Detalhes" icon="fa fa-fw fa-list"
							id="btn-view" outcome="/cadastros/CadastroProdutos.xhtml"
							onclick="PF('downloadLoading').show();">
							<f:param name="id"
								value="#{estoqueBean.produtoSelecionado.id}" />
						</p:menuitem>
						
						<p:menuitem icon="fa fa-fw fa-trash" id="btn-trash" 
							value="Excluir" process="@this" disabled="#{not seguranca.acessoAdministrador()}"
							onclick="deleteItem(#{estoqueBean.produtoSelecionado.id});" />
					</p:menuButton>
					
					<p:commandButton icon="fa fa-fw fa-download"
						disabled="#{estoqueBean.produtosSize == 0}"
						style="width: 38px;float: right;margin-right: 93px;margin-top: -40px;" process="@this" ajax="false">
	                    <p:dataExporter type="xls" target="produtosTable" fileName="Tabela De Preços"/>
	                </p:commandButton>

					<p:panelGrid columns="1" layout="grid"
						styleClass="panelgrid-noborder disabled disabled"
						columnClasses="ui-grid-col-12">

						<p:dataTable id="produtosTable" paginatorAlwaysVisible="false"
							scrollable="true" scrollHeight="470"
							value="#{estoqueBean.produtosFiltrados}" var="produto"
							emptyMessage="Nenhum resultado encontrado." 
							reflow="true" paginator="false" 
							rowKey="#{produto.id}"
							selection="#{estoqueBean.produtoSelecionado}"
							selectionMode="single">

							<p:ajax process="@this produtosTable" event="rowSelect"
								update="foto-button form-dialog" onstart="PF('downloadLoading').show();"
								oncomplete="PF('downloadLoading').hide();" />
								
							<p:ajax process="@this produtosTable" event="rowUnselect" onstart="PF('downloadLoading').show();"
								oncomplete="PF('downloadLoading').hide();" update="foto-button form-dialog" />

							<p:column headerText="Código" exportHeaderValue="Código" styleClass="font-column" width="15%">
								<h:outputText value="#{produto.codigo}" />
							</p:column>
							
							<p:column headerText="Código De Barras" width="15%" visible="false">
								<h:outputText value="#{produto.codigoDeBarras}" />
							</p:column>
							
							<p:column headerText="Nome" width="20%" styleClass="font-column">
								<h:outputText value="#{produto.nome}" />
							</p:column>

							<p:column headerText="Descrição" width="25%" styleClass="font-column">
								<h:outputText value="#{produto.descricao}" />
							</p:column>

							<p:column headerText="Qtd. Atual" width="15%" styleClass="font-column">
								<h:outputText value="#{produto.quantidadeAtual}" rendered="#{(produto.unidadeMedida == 'Kg' or produto.unidadeMedida == 'Lt') and produto.estoque}">
									<f:convertNumber minFractionDigits="3" />
								</h:outputText>
								
								<h:outputText value=" #{produto.unidadeMedida}" rendered="#{(produto.unidadeMedida == 'Kg' or produto.unidadeMedida == 'Lt') and produto.estoque}">
								</h:outputText>
								
								<h:outputText value="#{produto.quantidadeAtual}" rendered="#{produto.unidadeMedida == 'Pt' and produto.estoque}">
									<f:convertNumber minFractionDigits="1" />
								</h:outputText>
								
								<h:outputText value=" #{produto.unidadeMedida}" rendered="#{produto.unidadeMedida == 'Pt' and produto.estoque}">
								</h:outputText>
								
								<h:outputText value="#{produto.quantidadeAtual}" rendered="#{(produto.unidadeMedida != 'Kg' and produto.unidadeMedida != 'Lt' and produto.unidadeMedida != 'Pt') and produto.estoque}">
									<f:convertNumber minFractionDigits="0" />
								</h:outputText>
								
								<h:outputText value=" #{produto.unidadeMedida}" rendered="#{(produto.unidadeMedida != 'Kg' and produto.unidadeMedida != 'Lt' and produto.unidadeMedida != 'Pt') and produto.estoque}">
								</h:outputText>
								
								<h:outputText value="-" rendered="#{not produto.estoque}">
								</h:outputText>
							</p:column>
							
							<p:column headerText="Cor" width="20%" styleClass="font-column" rendered="false">
								<h:outputText value="#{produto.cor}" />
							</p:column>
							
							<p:column headerText="Tamanho" width="15%" styleClass="font-column">
								<h:outputText value="#{(produto.numeracao != null and produto.numeracao != '') ? produto.numeracao : '-'}" />
							</p:column>	
							
							<p:column headerText="Custo Médio" width="15%" styleClass="font-column_" rendered="#{not seguranca.acessoVendedor()}">
								<h:outputText value="#{produto.custoMedioUnitario}">
									<f:convertNumber type="currency" maxFractionDigits="4" />
								</h:outputText>
							</p:column>
							
							<p:column headerText="Preço Venda" width="15%" styleClass="font-column_">
								<h:outputText value="#{produto.precoDeVenda}">
									<f:convertNumber type="currency" />
								</h:outputText>
							</p:column>

							<p:column headerText="Perc. Venda" width="15%"
								visible="#{estoqueBean.pedido}" exportable="false">
								<h:outputText value="#{produto.percentualVenda}" />
							</p:column>

							<p:column headerText="Qtd. Pedido" width="15%"
								visible="#{estoqueBean.pedido}" exportable="false">
								<h:outputText value="#{produto.quantidadePedido}" />
							</p:column>

							<p:column headerText="Categoria" width="20%" styleClass="font-column">
								<h:outputText value="#{produto.categoriaProduto.nome}" />
							</p:column>

						</p:dataTable>

						<p:outputLabel value="Estoque total: #{estoqueBean.estoqueTotal}"
							style="float:left;margin-top:10px;margin-bottom:5px;margin-left:-10px;font-size: 13px;font-family: inherit;" />
					</p:panelGrid>

				</p:panel>

			</div>

		</h:form>


		<p:dialog header="Produto selecionado" widgetVar="produto-dialog"  position="top" style="margin-top: 100px"
			id="produto-dialog" resizable="false" modal="true"
			closeOnEscape="true" responsive="true" 
			styleClass="fotoDialog">

			<h:form id="form-dialog">

				<div class="ui-fluid" style="margin-top: 10px; text-align: center">
					<ui:fragment id="photo"
						rendered="#{estoqueBean.produtoSelecionado.urlImagem != null}">
						<img 
							src="#{estoqueBean.produtoSelecionado.urlImagem}"
							style="width: 200px; height: 250px;" />
					</ui:fragment>

					<div
						style="width: 80%; margin: auto; border-top: 1px solid #ccc; margin-top: 10px; margin-bottom: 10px"></div>

					<p:button icon="fa fa-fw fa-list"
						style="margin-bottom: 5px;font-weight: bold;float: right;width: 100px;margin-right: 5px;background:#147df0"
						value="Detalhes" id="foto-button" 
						outcome="/cadastros/CadastroProdutos.xhtml"
						onclick="PF('downloadLoading').show();">

						<f:param name="id" value="#{estoqueBean.produtoId}" />
					</p:button>

					<p:commandButton icon="fa fa-fw fa-close"
						style="margin-bottom: 5px;font-weight: bold;width: 100px;background:#e15e5ef0;"
						value="Fechar" 
						onstart="PF('downloadLoading').show();"
						oncomplete="PF('downloadLoading').hide();PF('produto-dialog').hide();">
					</p:commandButton>
				</div>
			</h:form>
		</p:dialog>
		
		
		
		<p:dialog header="Produto selecionado" widgetVar="produto-dialog_" position="center"
			id="produto-dialog_" resizable="false" modal="true" 
			closeOnEscape="true" responsive="true" 
			styleClass="fotoDialog_">
			
			

			<h:form id="form-dialog_">
			
				<div class="ui-fluid" style="margin-top: 5px; text-align: center">
												
					<p:panelGrid columns="2" layout="grid"
						styleClass="panelgrid-noborder disabled disabled"
						columnClasses="ui-grid-col-5, ui-grid-col-7">
						
						<p:panel>
						
							<p:panelGrid columns="1" layout="grid"
								styleClass="panelgrid-noborder disabled disabled"
								columnClasses="ui-grid-col-12">
								
								<ui:fragment id="photo2" 
									rendered="#{estoqueBean.produtoSelecionado.urlImagem != null and estoqueBean.configuracao.produtosUrlNuvem}">
									<img class="image-produto_"
										src="#{estoqueBean.produtoSelecionado.urlImagem}" />
								</ui:fragment>
								
								<p:graphicImage value="../../produtos/#{estoqueBean.produtoSelecionado.id}.jpg" cache="true"
									styleClass="image-produto_"
									rendered="#{estoqueBean.produtoSelecionado.urlImagem != null and not estoqueBean.configuracao.produtosUrlNuvem}">
								</p:graphicImage>
								
								<ui:fragment id="photo2_"  
									rendered="#{estoqueBean.produtoSelecionado.urlImagem == null}">
									<p:graphicImage styleClass="image-produto_" library="myapp" name="/images/sem-foto.png" width="166px" height="176px" />
								</ui:fragment>
								
								<ui:fragment id="photo"
									rendered="false">
									<img style="width: 200px; height: auto;margin-left: -10px;"
										src="data:image/png;base64,#{devolucoesTrocaBean.imageContentsAsBase64}"
										class="image-produto" />
								</ui:fragment>
							</p:panelGrid>
						
						</p:panel>
						
					
					
						<p:panelGrid columns="1" layout="grid" style="text-align:left;"
							styleClass="panelgrid-noborder disabled disabled info-desc"
							columnClasses="ui-grid-col-12">
							
								<p:outputLabel
									value="#{estoqueBean.produtoSelecionado.nome}"
									style="font-size: 16px;font-weight: bold;" />
									
								<p:outputLabel
									value="#{estoqueBean.produtoSelecionado.descricao}"
									style="font-size: 22px;font-weight: bold;float:left;margin-top: -10px;" />
									
								<p:outputLabel value="cod.: #{estoqueBean.produtoSelecionado.codigo}" style="float: left;margin-top: -8px;" />
								
								
								<p:outputLabel value="Preço de Venda/#{estoqueBean.produtoSelecionado.unidadeMedida}."
										style="font-weight: bold;font-size: 12px;" />
									
								<p:panel>
									<p:outputLabel id="valor-pago" value="#{estoqueBean.produtoSelecionado.precoDeVenda}"
										style="font-size: 28px;font-weight: bold;margin-top: -10px;float: left;">
										
										<f:convertNumber type="currency" />
									</p:outputLabel>
									
									<p:outputLabel value="#{estoqueBean.produtoSelecionado.unidadeMedida}" style="font-weight:bold;margin-top:8px;margin-left:5px;float:left;font-size:10px;" />										
								</p:panel>
								
								<p:panel style="text-align:left;"
									styleClass="panelgrid-noborder disabled disabled info-valores">
									
									<p:tooltip id="tooltip" for="edit-qtde" style="font-size:12px;" value="Ajustar Quantidade"
               							showEffect="clip" hideEffect="explode" position="left"/>
               							
               						<p:tooltip id="tooltip_" for="edit-custo" style="font-size:12px;" value="Atualizar Custo Médio"
               							showEffect="clip" hideEffect="explode" position="left"/>
									
									<p:panel style="float:left;width:48%;">									
										<p:panelGrid columns="1" layout="grid" style="text-align:left;"
											styleClass="panelgrid-noborder disabled disabled"
											columnClasses="ui-grid-col-12">
								
											<p:outputLabel value="Qtd. atual" for="quantidade_" />
											<p:inputNumber id="quantidade_" decimalPlaces="3" 
												rendered="#{estoqueBean.produtoSelecionado.unidadeMedida != 'Un' and estoqueBean.produtoSelecionado.unidadeMedida != 'Cx' and estoqueBean.produtoSelecionado.unidadeMedida != 'Fardo' and estoqueBean.produtoSelecionado.unidadeMedida != 'Pt'}"
												placeholder="0,000" styleClass="quantidade" onkeyup="ajaxDelay('')"
												disabled="true"
												value="#{estoqueBean.produtoSelecionado.quantidadeAtual}">
		
												<p:ajax event="keyup" process="@this"></p:ajax>
											</p:inputNumber>
											
											<p:inputNumber id="quantidade__" decimalPlaces="0" label="Quantidade"
												rendered="#{estoqueBean.produtoSelecionado.unidadeMedida == 'Un' or estoqueBean.produtoSelecionado.unidadeMedida == 'Cx' or estoqueBean.produtoSelecionado.unidadeMedida == 'Fardo'}"
												placeholder="0" styleClass="quantidade" onkeyup="ajaxDelay('')"
												disabled="true"
												value="#{estoqueBean.produtoSelecionado.quantidadeAtual}">
		
												<p:ajax event="keyup" process="@this"></p:ajax>
											</p:inputNumber>
											
											<p:inputNumber id="quantidade___" decimalPlaces="1" label="Quantidade"
												rendered="#{estoqueBean.produtoSelecionado.unidadeMedida == 'Pt'}"
												placeholder="0,0" styleClass="quantidade" onkeyup="ajaxDelay('')"
												disabled="true"
												value="#{estoqueBean.produtoSelecionado.quantidadeAtual}">
		
												<p:ajax event="keyup" process="@this"></p:ajax>
											</p:inputNumber>
											
											<p:commandButton id="edit-qtde" rendered="false"
												style="width: 22px;
											    height: 22px;
											    float: right;
											    margin-top: -65px;
											    margin-right: 0px;
												background: #f9f9f9;
												margin-right: -1px;													
											    border: none;" icon="fa fa-fw fa-edit"
											    update="form-ajuste-dialog" process="@this"
											    actionListener="#{estoqueBean.prepararAjusteQuantidade}"
											    onstart="PF('downloadLoading').show();"
												oncomplete="PF('downloadLoading').hide();PF('ajuste-dialog').show();">	
												
												<p:resetInput target="form-ajuste-dialog" />
											</p:commandButton>
										</p:panelGrid>
									</p:panel>
									
									<p:panel style="float:right;width:48%;">
										<p:panelGrid columns="1" layout="grid" style="text-align:left;"
											styleClass="panelgrid-noborder disabled disabled"
											columnClasses="ui-grid-col-12" rendered="#{not seguranca.acessoVendedor()}">
											
											<p:outputLabel value="Custo médio" for="custo-medio" />
											<p:inputNumber id="custo-medio" decimalPlaces="4"
												placeholder="0,000" styleClass="quantidade" onkeyup="ajaxDelay('')"
												disabled="true"
												value="#{estoqueBean.produtoSelecionado.custoMedioUnitario}">
		
												<p:ajax event="keyup" process="@this"></p:ajax>
											</p:inputNumber>
											
											<p:commandButton id="edit-custo" rendered="false"
												style="width: 22px;
											    height: 22px;
											    float: right;
											    margin-top: -65px;
											    margin-right: 0px;
												background: #f9f9f9;
												margin-right: -1px;												
											    border: none;" icon="fa fa-fw fa-edit"												
											    update="form-custo-dialog" process="@this"
											    actionListener="#{estoqueBean.prepararAtualizacaoCustoMedio}"
											    onstart="PF('downloadLoading').show();"
												oncomplete="PF('downloadLoading').hide();PF('custo-dialog').show();">	
												
												<p:resetInput target="form-custo-dialog" />
											</p:commandButton>
										</p:panelGrid>
									</p:panel>
								</p:panel>
						</p:panelGrid>
					
					</p:panelGrid>	

					<div class="line"></div>

					<p:panel>
											
						<p:commandButton icon="fa fa-fw fa-retweet" rendered="false"
								style="margin-bottom: 5px;font-weight: bold;float: right;width: 145px;margin-right: 3px;background-color: #0d8819b5;"
								value="Devolver e Trocar" id="devolver-trocar_" onstart="PF('downloadLoading').show();"
								oncomplete="PF('downloadLoading').hide();PF('produto-dialog_').hide();"
								action="#{devolucoesTrocaBean.devolucaoTrocaSelecionada}"
								process="@this produto-dialog_" update="form" />
						
						<p:button icon="fa fa-fw fa-list"
								style="margin-bottom: 5px;font-weight: bold;float: right;width: 100px;margin-right: 3px;background:#147df0"
								value="Detalhes" onstart="PF('downloadLoading').show();"
								oncomplete="PF('downloadLoading').hide();"
								outcome="/cadastros/CadastroProdutos.xhtml">
								
								<f:param name="id"
								value="#{estoqueBean.produtoSelecionado.id}" />
						</p:button>
	
						<p:commandButton icon="fa fa-fw fa-close"
							style="float:right;margin-right: 3px;margin-bottom: 5px;font-weight: bold;width: 100px;background:#e15e5ef0;"
							value="Fechar" 
							onstart="PF('downloadLoading').show();"
							oncomplete="PF('downloadLoading').hide();PF('produto-dialog_').hide();">
						</p:commandButton>
					</p:panel>
					
				</div>
			</h:form>
		</p:dialog>
		
		
		
		
		<p:dialog 
			header="Ajuste de Quantidade"
			widgetVar="ajuste-dialog" id="ajuste-dialog" resizable="false" position="center" 
			modal="true" closeOnEscape="true" responsive="true" width="280px">

			<h:form id="form-ajuste-dialog">

				<div class="ui-fluid">
					<p:defaultCommand target="salva-quantidade" />

					<div class="card card-w-title ui-fluid"
						style="padding: 0px 5px 0px 5px; padding-bottom: 0px !important;margin-bottom: 5px;margin-top:15px;">
						
						<p:panelGrid columns="2" layout="grid" 
							styleClass="panelgrid-noborder disabled disabled"
							columnClasses="ui-grid-col-6, ui-grid-col-6">

							<p:outputLabel for="nova-quantidade" style="font-weight: bold;font-size: 13px;" value="Quantidade atual (#{estoqueBean.produtoSelecionado.unidadeMedida})" />
							
							<p:inputNumber id="nova-quantidade" decimalPlaces="0" placeholder="0" minValue="0"
								styleClass="quantidade" onkeyup="ajaxDelayQtd()" onchange="ajaxDelayQtd()" onblur="ajaxDelayQtd()"
								value="#{estoqueBean.novaQuantidadeAtual}"
								rendered="#{estoqueBean.produtoSelecionado.unidadeMedida == 'Un' or estoqueBean.produtoSelecionado.unidadeMedida == 'Cx' or estoqueBean.produtoSelecionado.unidadeMedida == 'Fardo'}">

							</p:inputNumber>
							
							<p:inputNumber id="nova-quantidade_" decimalPlaces="3" placeholder="0,000" minValue="0"
								styleClass="quantidade_" onkeyup="ajaxDelayQtd_()" onchange="ajaxDelayQtd_()" onblur="ajaxDelayQtd_()"
								value="#{estoqueBean.novaQuantidadeAtual}"
								rendered="#{estoqueBean.produtoSelecionado.unidadeMedida == 'Kg' or estoqueBean.produtoSelecionado.unidadeMedida == 'Lt'}">

							</p:inputNumber>
							
							<p:inputNumber id="nova-quantidade__" decimalPlaces="1" placeholder="0,0" minValue="0"
								styleClass="quantidade__" onkeyup="ajaxDelayQtd__()" onchange="ajaxDelayQtd__()" onblur="ajaxDelayQtd__()"
								value="#{estoqueBean.novaQuantidadeAtual}"
								rendered="#{estoqueBean.produtoSelecionado.unidadeMedida == 'Pt'}">

							</p:inputNumber>

						</p:panelGrid>
						
		
						<div
							style="width: 100%; margin-left: -15px;
    						padding-left: 32px;margin-top: 16px;margin-bottom: 10px; 
    						border-top: 1px solid #ccc"></div>
						
						
						<p:panel class="card card-w-title ui-fluid panel-btn"
								style="padding-bottom: 7px;margin-bottom: 20px;margin-top: -5px;">
							
							<p:commandButton value="Salvar" id="salva-quantidade" icon="fa fa-fw fa-save"
								widgetVar="btn-save" process="@this ajuste-dialog"
								onstart="PF('downloadLoading').show(); PF('btn-save').disable();"
								onsuccess="PF('downloadLoading').hide(); PF('btn-save').enable();"
								update="msg form-ajuste-dialog form-dialog_ produtosTable"								
								action="#{estoqueBean.ajustarQuantidade}"
								style="font-weight: bold;background-color: #0d8819b5; width: 97px;float: right;" />
	
							<p:commandButton icon="fa fa-fw fa-close" value="Fechar"
								oncomplete="PF('ajuste-dialog').hide();" process="@this"
								style="margin-left:1px;background-color: #e15e5ef0; font-weight: bold; width: 97px;float: right;">
	
							</p:commandButton>
						</p:panel>

					</div>
				</div>
			</h:form>
		</p:dialog>
		
		
		
		
		<p:dialog 
			header="Atualizar Custo Médio"
			widgetVar="custo-dialog" id="custo-dialog" resizable="false" position="center" 
			modal="true" closeOnEscape="true" responsive="true" width="280px">

			<h:form id="form-custo-dialog">

				<div class="ui-fluid">
					<p:defaultCommand target="salva-custo" />

					<div class="card card-w-title ui-fluid"
						style="padding: 0px 5px 0px 5px; padding-bottom: 0px !important;margin-bottom: 5px;margin-top:15px;">
						
						<p:panelGrid columns="2" layout="grid" 
							styleClass="panelgrid-noborder disabled disabled"
							columnClasses="ui-grid-col-6, ui-grid-col-6">

							<p:outputLabel for="custo-medio_" style="font-weight: bold;font-size: 13px;" value="Custo médio" />
										
							<p:inputNumber id="custo-medio_" decimalPlaces="4" placeholder="0,0000" minValue="0"
								styleClass="quantidade_" onkeyup="ajaxDelayQtd_()" onchange="ajaxDelayQtd_()" onblur="ajaxDelayQtd_()"
								value="#{estoqueBean.novoCustoMedio}">

							</p:inputNumber>

						</p:panelGrid>
						
		
						<div
							style="width: 100%; margin-left: -15px;
    						padding-left: 32px;margin-top: 16px;margin-bottom: 10px; 
    						border-top: 1px solid #ccc"></div>
						
						
						<p:panel class="card card-w-title ui-fluid panel-btn"
								style="padding-bottom: 7px;margin-bottom: 20px;margin-top: -5px;">
							
							<p:commandButton value="Salvar" id="salva-custo" icon="fa fa-fw fa-save"
								widgetVar="btn-save" process="@this form-custo-dialog"
								onstart="PF('downloadLoading').show(); PF('btn-save').disable();"
								onsuccess="PF('downloadLoading').hide(); PF('btn-save').enable();"
								update="msg form-custo-dialog form-dialog_ produtosTable"								
								action="#{estoqueBean.atualizarCustoMedio}"
								style="font-weight: bold;background-color: #0d8819b5; width: 97px;float: right;" />
	
							<p:commandButton icon="fa fa-fw fa-close" value="Fechar"
								oncomplete="PF('custo-dialog').hide();" process="@this"
								style="margin-left:1px;background-color: #e15e5ef0; font-weight: bold; width: 97px;float: right;">
	
							</p:commandButton>
						</p:panel>

					</div>
				</div>
			</h:form>
		</p:dialog>
		



		<p:dialog id="downloadLoading" showHeader="false" modal="true"
			widgetVar="downloadLoading" header="Status" draggable="false"
			closable="false" resizable="false">
			<p:graphicImage name="images/loadingbar.gif"
				library="manhattan-layout" width="50" />
		</p:dialog>

		<script type="text/javascript">
			function start() {
				PF('downloadLoading').show();
			}

			function stop() {
				PF('downloadLoading').hide();
			}
		</script>

	</ui:define>

</ui:composition>
