<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

	<ui:define name="title">Dashboard</ui:define>

	<ui:define name="head">

		<script type="text/javascript">
			function percentExtender() {
				var tickColor = "#666";
				var gridlineColor = "rgba(0,0,0,0.1)";

				this.cfg.config.type = 'pie';

				this.cfg.config.options = {
					legend : {
						display : true,
					},

					title : {
						display : true,
						text : 'Top 5 Despesas - Mês atual'
					},
					tooltips : {
						callbacks : {

							label : function(tooltipItem, data) {
								var amount = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];

								var total = eval(data.datasets[tooltipItem.datasetIndex].data
										.join("+"));

								var label = tooltipItem.yLabel;

								return numberToReal(amount)
										+ ' / '
										+ numberToReal(total)
										+ ' ( '
										+ parseFloat(amount * 100 / total)
												.toFixed(2) + '% )';
							}
						}
					},
				};
			}

			function percentExtender2() {

				this.cfg.config.options = {
					legend : {
						display : true,
					},

					title : {
						display : true,
						text : 'Total de Vendas vs Dia da Semana'
					},
					tooltips : {
						callbacks : {

							label : function(tooltipItem, data) {
								var amount = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];

								return numberToReal(amount);
							}
						}
					},
				};
			}

			function percentExtender3() {

				this.cfg.config.options = {
					legend : {
						display : true,
					},

					title : {
						display : true,
						text : 'Total de Vendas vs Categoria'
					},
					tooltips : {
						callbacks : {

							label : function(tooltipItem, data) {
								var amount = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];

								return numberToReal(amount);
							}
						}
					},
				};
			}

			function percentExtender4() {

				this.cfg.config.options = {
					legend : {
						display : true,
					},

					title : {
						display : true,
						text : 'Estoque para Vendas vs Categoria'
					},
					tooltips : {
						callbacks : {

							label : function(tooltipItem, data) {
								var amount = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];

								return numberToReal(amount);
							}
						}
					},
				};
			}

			function percentExtender5() {

				this.cfg.config.options = {
					legend : {
						display : true,
					},

					title : {
						display : true,
						text : ''
					},
					tooltips : {
						callbacks : {

							label : function(tooltipItem, data) {
								var amount = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];

								var valor = numberToReal(amount);
								if (valor.includes("-.")) {
									valor = valor.replace("-.", "-");
								}
								return valor;
							}
						}
					},
				/*
				scales: {
				     yAxes: [{
				        display: true,
				        scaleLabel: {
				           display: true,
				           labelString: '',
				        },
				        ticks: {
				           callback: function (value, index, values) {
				               value = value * 100;
				              return "";
				           },
				        },
				     }]
				  }
				 */
				};
			}

			function numberToReal(numero) {
				var numero = numero.toFixed(2).split('.');
				numero[0] = "R$ " + numero[0].split(/(?=(?:...)*$)/).join('.');

				return numero.join(',');
			}
		</script>

		<style>
body .ui-datatable thead th {
	display: none;
}

body .ui-datatable .ui-datatable-data>tr.ui-datatable-even {
	background-color: transparent;
	border-bottom: 1px solid #afc7ff;
}

body .ui-datatable .ui-datatable-data>tr {
	background-color: #f1f1f1;
}

body .ui-widget-content {
	background-color: transparent;
	border: 1px solid #b6b7c2;
}

body .ui-datatable .ui-datatable-data>tr {
	border-color: transparent;
}

body .ui-datatable .ui-datatable-data>tr td {
	padding: 0px 10px;
	font-weight: bold;
	font-size: 12px;
	color: #525252;
}

.dashboard .overview-box.overview-box-1 .overview-box-icon i {
    color: #069ed2;
}

.dashboard .overview-box.overview-box-1 .overview-box-icon {
    background-color: #197290;
}

.layout-wrapper .layout-main .layout-content {
	padding: 60px 17px 4px 17px;
}

.acesso-rapido a:hover {
	background: #f3f3f3;
}

@media ( min-width :220px) {
	.dashboard-top {
		margin-top: -5px;
	}
	.dashboard-bottom {
		margin-top: -10px;
	}
	.fluxo-caixa {
		margin-top: -20px;
	}
	.ui-datatable table {
		border-collapse: separate;
	}
	.ui-datatable tbody td {
		height: 25px;
	}
	.fluxo-caixa tr td:nth-child(1) {
		border-bottom: 1.3px solid rebeccapurple;
	}
	.fluxo-caixa tr td:nth-child(2) {
		border-bottom: 1px solid #0e71dc;
	}
	.dashboard .overview-box .overview-box-content .overview-box-title {
		font-weight: bold;
	}
	.dashboard .overview-box.overview-box-1 .overview-box-details {
		color: #efefef;
		font-size: 12px;
	}
	.dashboard .overview-box .overview-box-content .overview-box-stats {
		font-size: 24px;
	}
	.dashboard .overview-box.overview-box-3 {
		background-color: #ffffff;
		border: 1px solid #a7a7a7;
		border-radius: 5px;
	}
	.dashboard .overview-box.overview-box-3 .overview-box-details {
		color: #e5d7ff;
	}
	.dashboard .overview-box.overview-box-1 {
		background-color: #069ed2;
		border-radius: 5px;
		height: 138px;
	}
	.dashboard .overview-box .overview-box-content {
		margin-top: 12px;
		margin-left: 15px;
	}
	.dashboard .overview-box.overview-box-1 .overview-box-icon {
		margin-top: -1px;
	}
}

@media ( min-width :460px) {
	.dashboard-top {
		margin-top: -5px;
	}
	.dashboard-bottom {
		margin-top: -10px;
	}
	.fluxo-caixa {
		margin-top: 35px;
	}
	.acesso-rapido .ui-lg-3 {
		padding: 0em !important;
		width: 100%;
	}
}
</style>
	</ui:define>

	<ui:define name="content">

		<div class="page-header">
			<h1>Dashboard</h1>
		</div>

		<h:form id="form">

			<div class="ui-g dashboard" style="margin-top: -25px">

				<div class="ui-g-12 ui-lg-6 ui-xl-3">
					<div class="ui-g overview-box overview-box-1">
						<div class="overview-box-icon">
							<i class="fa fa-inbox"></i>
						</div>
						<div class="overview-box-content">
							<div class="overview-box-title">Bom dia, Tácito!</div>
							<div class="overview-box-stats">R$ #{dashboardBean.saldoGeral}</div>
							<div class="overview-box-details">Saldo geral</div>
						</div>
					</div>
				</div>

				<div class="ui-g-12 ui-lg-6 ui-xl-3 acesso-rapido">
					<div class="ui-g overview-box overview-box-3" style="padding: 0px">

						<label style="color: #585858; font-weight: bold; margin: 6px 8px">Acesso
							rápido</label>
						<div class="ui-g ui-g-12">

							<p:link href="/operacoes/RegistroCompras.xhtml"
								style="width: 25%;text-align: center;border-radius: 5px;">
								<div class="ui-lg-3">
									<div class="overview-box-icon">
										<i class="fa fa-shopping-cart"></i>
									</div>
									<p style="color: #000">Comprar</p>
								</div>
							</p:link>

							<p:link href="/operacoes/RegistroVendas.xhtml"
								style="width: 25%;text-align: center;border-radius: 5px;">
								<div class="ui-lg-3">
									<div class="overview-box-icon">
										<i class="fa fa fa-dollar fa-fw"></i>
									</div>
									<p style="color: #000">Vender</p>
								</div>
							</p:link>

							<p:link href="/operacoes/RegistroLancamentos.xhtml"
								style="width: 25%;text-align: center;border-radius: 5px;">
								<div class="ui-lg-3">
									<div class="overview-box-icon">
										<i class="fa fa-minus"></i>
									</div>
									<p style="color: #000">Despesa</p>
								</div>
							</p:link>

							<p:link href="/operacoes/RegistroLancamentos.xhtml"
								style="width: 25%;text-align: center;border-radius: 5px;">
								<div class="ui-lg-3">
									<div class="overview-box-icon">
										<i class="fa fa-plus"></i>
									</div>
									<p style="color: #000">Receita</p>
								</div>
							</p:link>
						</div>
					</div>
				</div>

				
				<div class="ui-g-12 dashboard-top">
					<div class="ui-g-12 ui-lg-8 ui-xl-7" >

						<label style="font-weight: bold;font-size:14px">Fluxo de Caixa</label>
						<p:barChart model="#{dashboardBean.barModel}"
							style="width: 100%; height: 250px;margin-top:-25px" />



					</div>

					<div class="ui-g-12 ui-lg-4 ui-xl-5">
						<p:barChart model="#{dashboardBean.mixedModel}" rendered="false"
							style="width: 100%; height: 255px;" />

						<p:dataTable id="fluxoTable" rows="10"
							value="#{dashboardBean.tabela}" var="fluxoDeCaixa"
							styleClass="fluxo-caixa">

							<p:column headerText="Item" width="10%" style="text-align:left">
								<h:outputText value="#{fluxoDeCaixa.item}" />
							</p:column>

							<p:column headerText="Valor" width="80%" style="text-align:right">
								<h:outputText value="#{fluxoDeCaixa.value}">
									<f:convertNumber type="currency" />
								</h:outputText>
							</p:column>

						</p:dataTable>
					</div>
				</div>

				<div class="ui-g-12 dashboard-bottom">
					<div class="ui-g-12 ui-lg-4 ui-xl-4">
						<p:donutChart model="#{dashboardBean.donutModel}"
							style="width: 100%; height: 230px;" />
					</div>

					<div class="ui-g-12 ui-lg-4 ui-xl-4">
						<p:polarAreaChart model="#{dashboardBean.polarAreaModel}"
							style="width: 100%; height: 230px;" />
					</div>

					<div class="ui-g-12 ui-lg-4 ui-xl-4">
						<p:pieChart model="#{dashboardBean.pieModel}"
							style="width: 100%; height: 230px;" />
					</div>
				</div>
			</div>

		</h:form>

		<p:dialog header="Fluxo de Caixa" widgetVar="fluxo-caixa"
			id="fluxo-caixa" resizable="false" modal="true" closeOnEscape="true"
			responsive="true" position="center" styleClass="modal-donut"
			width="250px">

			<h:form id="form-dialog">

				<div class="ui-fluid">

					<div class="card card-w-title ui-fluid"
						style="padding: 0px 5px 0px 5px; padding-bottom: 0px !important; margin-bottom: 10px; text-align: center">

						<p:dataTable id="fluxoTable2" rows="10" style="margin-top:10px"
							value="#{dashboardBean.tabela}" var="fluxoDeCaixa">

							<p:column headerText="Item" width="20%">
								<h:outputText value="#{fluxoDeCaixa.item}" />
							</p:column>

							<p:column headerText="Valor" width="20%">
								<h:outputText value="#{fluxoDeCaixa.value}">
									<f:convertNumber type="currency" />
								</h:outputText>
							</p:column>

						</p:dataTable>

						<p:commandButton icon="fa fa-fw fa-close"
							style="margin-top: 15px;font-weight: bold;width: 120px;background: #f3f3f3f0;color: #716c6c;border: 1px solid #484545;"
							value="Fechar" oncomplete="PF('fluxo-caixa').hide();">
						</p:commandButton>

					</div>
				</div>
			</h:form>
		</p:dialog>

	</ui:define>

</ui:composition>
